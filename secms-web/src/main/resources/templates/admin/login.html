<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head th:include="./common/head :: header"></head>
<body>
<!--把导航栏模块包含我的页面里面-->
<div th:insert="./common/header :: navigator"></div>

<div class="layui-container fly-marginTop">
    <div class="fly-panel fly-panel-user" pad20>
        <div class="layui-tab layui-tab-brief" lay-filter="user">
            <ul class="layui-tab-title">
                <li class="layui-this" lay-id="studentLogin">学生登录</li>
                <li lay-id="teacherLogin">教师登录</li>
                <li lay-id="adminLogin">教务处登录</li>
            </ul>

            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                    <!--学生登录表单开始-->
                    <div class="layui-form layui-tab-content" id="LAY_ucm" style="padding: 20px 0;">
                        <div class="layui-tab-item layui-show">
                            <div class="layui-form layui-form-pane">
                                <div class="layui-form-item">
                                    <label for="L_email" class="layui-form-label">学号</label>
                                    <div class="layui-input-inline">
                                        <input type="text"  name="sno" required lay-verify="required"
                                               placeholder="请输入学号" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_pass" class="layui-form-label">密码</label>
                                    <div class="layui-input-inline">
                                        <input type="password"  name="password" required lay-verify="required"
                                               placeholder="请输入密码" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_vercode" class="layui-form-label">验证码</label>
                                    <div class="layui-input-inline">
                                        <input type="text"  name="randomCode" required lay-verify="required"
                                               placeholder="请输入验证码" autocomplete="off" class="layui-input">
                                    </div>
                                    <div class="layui-form-mid">
                                  <span style="color: #cc4f26;">
                                      <img alt="验证码" style="cursor: pointer; margin-top: -7px"
                                           onclick="this.src='./defaultKaptcha?id='+new Date()*1"
                                           th:src="@{/defaultKaptcha}"/>
                                  </span>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <button class="layui-btn" lay-submit="" lay-filter="loginStudentForm">立即登录</button>
                                    <span style="padding-left:20px;">
                                <a th:href="@{/toNotice}" target="_blank">忘记密码？</a>
                            </span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <!--学生登录表单结束-->
                <!--教师登录表单开始-->
                <div class="layui-tab-item">
                    <div class="layui-form layui-tab-content" style="padding: 20px 0;">
                        <div class="layui-tab-item layui-show">
                            <div class="layui-form layui-form-pane">
                                <div class="layui-form-item">
                                    <label for="L_email" class="layui-form-label">职工号</label>
                                    <div class="layui-input-inline">
                                        <input type="text" name="tno" required lay-verify="required"
                                               placeholder="请输入职工号" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_pass" class="layui-form-label">密码</label>
                                    <div class="layui-input-inline">
                                        <input type="password" name="password" required lay-verify="required"
                                               placeholder="请输入密码" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_vercode" class="layui-form-label">验证码</label>
                                    <div class="layui-input-inline">
                                        <input type="text" name="randomCode" required lay-verify="required"
                                               placeholder="请输入验证码" autocomplete="off" class="layui-input">
                                    </div>
                                    <div class="layui-form-mid">
                                  <span style="color: #cc4f26;">
                                      <img alt="验证码" style="cursor: pointer; margin-top: -7px"
                                           onclick="this.src='./defaultKaptcha?id='+new Date()*1"
                                           th:src="@{/defaultKaptcha}"/>
                                  </span>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <button class="layui-btn" lay-submit="" lay-filter="loginTeacherForm">立即登录
                                    </button>
                                    <span style="padding-left:20px;">
                                        <a th:href="@{/toNotice}" target="_blank">忘记密码？</a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!--教师登录表单结束-->
                <!--教务登录表单开始-->
                <div class="layui-tab-item">
                    <div class="layui-form layui-tab-content" style="padding: 20px 0;">
                        <div class="layui-tab-item layui-show">
                            <div class="layui-form layui-form-pane">
                                <div class="layui-form-item">
                                    <label for="L_email" class="layui-form-label">教务号</label>
                                    <div class="layui-input-inline">
                                        <input type="text" id="L_email" name="ano" required lay-verify="required"
                                               placeholder="请输入教务号" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_pass" class="layui-form-label">密码</label>
                                    <div class="layui-input-inline">
                                        <input type="password" id="L_pass" name="password" required
                                               lay-verify="required" placeholder="请输入密码" autocomplete="off"
                                               class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label for="L_vercode" class="layui-form-label">验证码</label>
                                    <div class="layui-input-inline">
                                        <input type="text" id="L_vercode" name="randomCode" required
                                               lay-verify="required" placeholder="请输入验证码" autocomplete="off"
                                               class="layui-input">
                                    </div>
                                    <div class="layui-form-mid">
                                  <span style="color: #cc4f26;">
                                      <img alt="验证码" style="cursor: pointer; margin-top: -7px"
                                           onclick="this.src='./defaultKaptcha?id='+new Date()*1"
                                           th:src="@{/defaultKaptcha}"/>
                                  </span>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <button class="layui-btn" lay-submit="" lay-filter="loginAdminForm">立即登录</button>
                                    <span style="padding-left:20px;">
                                        <a th:href="@{/toNotice}" target="_blank">忘记密码？</a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!--教务登录表单结束-->
            </div>
        </div>
    </div>
</div>

<!--把尾部的页面包含进来-->
<div th:replace="./common/footer :: footer"></div>

<script th:src="@{/res/layui/layui.js}"></script>
<script th:inline="javascript">
    layui.use(['form', 'element', 'layer'], function () {
        var $ = layui.$;  //使用jquery;
        var form = layui.form,
            element = layui.element,
            layer = layui.layer;
        // 监听提交学生表单
        /*<![CDATA[*/
        var loginStudentUrl = /*[[@{/student/login}]]*/;//学生登录URL
        var loginTeacherUrl = /*[[@{/teacher/login}]]*/;//学生登录URL
        var loginAdminUrl = /*[[@{/admin/login}]]*/;//学生登录URL
        var toIndexUrl = /*[[@{/toMain}]]*/;

        /*]]>*/
        form.on('submit(loginStudentForm)', function (data) {
            $.ajax({
                url: loginStudentUrl,
                type: "POST",
                dataType: 'json',
                async: true,
                data: {param: JSON.stringify(data.field)},
                success: function (resp) {
                    if (resp.meta.success) {
                        window.location.href = toIndexUrl;
                    } else if (resp.meta.message == 'randomCodeError') {
                        layer.ready(function () {
                            layer.msg('验证码不正确：请检查验证码');
                        });
                    } else if (resp.meta.message == 'snoError') {
                        layer.ready(function () {
                            layer.msg('学号不存在：请检查学号');
                        });
                    } else {
                        layer.ready(function () {
                            layer.msg('密码错误：请检查您输入的错误');
                        });
                    }
                }
            })
            return false;
        });
        // 监听提交教师表单
        form.on('submit(loginTeacherForm)', function (data) {
            $.ajax({
                url: loginTeacherUrl,
                type: "POST",
                dataType: 'json',
                async: true,
                data: {param: JSON.stringify(data.field)},
                success: function (resp) {
                    if (resp.meta.success) {
                        window.location.href = toIndexUrl;
                    } else if(resp.meta.message == 'randomCodeError') {
                        layer.ready(function () {
                            layer.msg('验证码不正确：请检查验证码');
                        });
                    }else if(resp.meta.message == 'tnoError') {
                        layer.ready(function () {
                            layer.msg('教工号不存在：请检查教工号');
                        });
                    } else {
                        layer.ready(function () {
                            layer.msg('密码错误：请检查您输入的错误');
                        });
                    }
                }
            })
            return false;
        });

        // 监听提交教务表单

        form.on('submit(loginAdminForm)', function (data) {
            $.ajax({
                url: loginAdminUrl,
                type: "POST",
                dataType: 'json',
                async: true,
                data: {param: JSON.stringify(data.field)},
                success: function (resp) {
                    if (resp.meta.success) {
                        window.location.href = toIndexUrl;
                    } else if(resp.meta.message == 'randomCodeError') {
                        layer.ready(function () {
                            layer.msg('验证码不正确：请检查验证码');
                        });
                    }else if(resp.meta.message == 'anoError') {
                        layer.ready(function () {
                            layer.msg('教务号不存在：请检查教务号');
                        });
                    } else {
                        layer.ready(function () {
                            layer.msg('密码错误：请检查您输入的错误');
                        });
                    }
                }
            })
            return false;
        });

    })
</script>
</body>
</html>